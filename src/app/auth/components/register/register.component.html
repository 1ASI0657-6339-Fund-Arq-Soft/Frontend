<div class="register-container">
  <div class="register-wrapper">
    <div class="register-brand">
      <div class="brand-content">
        <h1>AgeCare</h1>
        <p>Sistema integral de gesti칩n y cuidado para adultos mayores</p>
        <ul class="brand-features">
          <li>Seguro y confiable</li>
          <li>Monitoreo 24/7</li>
          <li>Comunicaci칩n familiar</li>
        </ul>
      </div>
    </div>

    <div class="register-form-wrapper">
      <div class="form-container">
        <h2>Registrate</h2>
        <p class="form-subtitle">Acceso a la plataforma de gesti칩n</p>

        <div *ngIf="error" class="alert alert-error">
          {{ error }}
        </div>

        <form [formGroup]="registerForm" (ngSubmit)="onSubmit()">
          <div class="form-group">
            <label for="name">
              <span class="icon">游녻</span>
              Usuario
            </label>
            <input
              type="text"
              id="name"
              formControlName="name"
              placeholder="Ingrese su usuario"
              class="form-input"
              [class.is-invalid]="submitted && f['name'].errors"
            />
            <div *ngIf="submitted && f['name'].errors" class="error-text">
              <span *ngIf="f['name'].errors['required']">El nombre es requerido</span>
              <span *ngIf="f['name'].errors['minlength']">M칤nimo 3 caracteres</span>
            </div>
          </div>

          <div class="form-group">
            <label for="email">
              <span class="icon">游닎</span>
              Correo
            </label>
            <input
              type="email"
              id="email"
              formControlName="email"
              placeholder="Ingrese su correo"
              class="form-input"
              [class.is-invalid]="submitted && f['email'].errors"
            />
            <div *ngIf="submitted && f['email'].errors" class="error-text">
              <span *ngIf="f['email'].errors['required']">El email es requerido</span>
              <span *ngIf="f['email'].errors['email']">Ingrese un email v치lido</span>
            </div>
          </div>

          <div class="form-group">
            <label for="password">
              <span class="icon">游</span>
              Contrase침a
            </label>
            <input
              type="password"
              id="password"
              formControlName="password"
              placeholder="Ingrese su contrase침a"
              class="form-input"
              [class.is-invalid]="submitted && f['password'].errors"
            />
            <div *ngIf="submitted && f['password'].errors" class="error-text">
              <span *ngIf="f['password'].errors['required']">La contrase침a es requerida</span>
              <span *ngIf="f['password'].errors['minlength']">M칤nimo 6 caracteres</span>
            </div>
          </div>

          <div class="form-group">
            <label for="confirmPassword">
              <span class="icon">游</span>
              Confirma Contrase침a
            </label>
            <input
              type="password"
              id="confirmPassword"
              formControlName="confirmPassword"
              placeholder="Ingrese su contrase침a"
              class="form-input"
              [class.is-invalid]="submitted && f['confirmPassword'].errors"
            />
            <div *ngIf="submitted && f['confirmPassword'].errors" class="error-text">
              <span *ngIf="f['confirmPassword'].errors['required']">Debe confirmar la contrase침a</span>
              <span *ngIf="f['confirmPassword'].errors['passwordMismatch']">Las contrase침as no coinciden</span>
            </div>
          </div>

          <div class="form-group">
            <label for="role">
              <span class="icon">游논</span>
              Tipo de Usuario
            </label>
            <select
              id="role"
              formControlName="role"
              class="form-input"
              [class.is-invalid]="submitted && f['role'].errors"
            >
              <option value="" disabled>Seleccione su rol</option>
              <option *ngFor="let role of roles" [value]="role.value">
                {{ role.label }}
              </option>
            </select>
            <div *ngIf="submitted && f['role'].errors" class="error-text">
              <span *ngIf="f['role'].errors['required']">Debe seleccionar un rol</span>
            </div>
          </div>

          <!-- Familiar: register resident in the same flow -->
          <div *ngIf="registerForm.get('role')?.value === 'familiar'" class="form-group resident-group">
            <h3>Datos del Residente</h3>
            <label for="residentName">Nombre Residente</label>
            <input id="residentName" formControlName="resident" [ngModel]="" (ngModelChange)="null" class="form-input" placeholder="Nombre del residente" />
            <small class="muted">(Se registrar치 al residente vinculado al familiar)</small>
            <div class="grid">
              <div>
                <label for="birthDate">Fecha de Nacimiento</label>
                <input id="birthDate" type="date" formControlName="resident" class="form-input" />
              </div>
              <div>
                <label for="medicalId">ID M칠dico</label>
                <input id="medicalId" formControlName="resident" class="form-input" placeholder="ID m칠dico" />
              </div>
            </div>
          </div>

          <!-- Doctor verification fields -->
          <div *ngIf="registerForm.get('role')?.value === 'doctor'" class="form-group doctor-group">
            <h3>Verificaci칩n Doctor</h3>
            <div class="form-group">
              <label for="licenseNumber">N칰mero de Colegiatura</label>
              <input id="licenseNumber" formControlName="doctor" class="form-input" placeholder="N칰mero de colegiatura" />
            </div>
            <div class="form-group">
              <label for="specialty">Especialidad</label>
              <input id="specialty" formControlName="doctor" class="form-input" placeholder="Especialidad" />
            </div>
            <div class="form-group">
              <label for="clinic">Centro / Cl칤nica</label>
              <input id="clinic" formControlName="doctor" class="form-input" placeholder="Instituci칩n" />
            </div>
            <div class="form-group">
              <label for="verificationDocument">Documento (opcional)</label>
              <input id="verificationDocument" type="file" (change)="null" class="form-input" />
            </div>
            <small class="muted">Se solicitar치 verificaci칩n administrativa despu칠s del registro.</small>
          </div>

          <!-- Quick role shortcuts like login -->
          <div class="quick-role-select form-group">
            <p class="muted">Registrar como:</p>
            <div class="quick-buttons">
              <button type="button" class="btn-quick btn-familiar" (click)="registerForm.patchValue({ role: 'familiar' })">Familiar</button>
              <button type="button" class="btn-quick btn-cuidador" (click)="registerForm.patchValue({ role: 'cuidador' })">Cuidador</button>
              <button type="button" class="btn-quick btn-doctor" (click)="registerForm.patchValue({ role: 'doctor' })">Doctor</button>
            </div>
          </div>

          <button
            type="submit"
            class="btn btn-primary"
            [disabled]="loading"
          >
            <span *ngIf="!loading">Ingresar al Sistema</span>
            <span *ngIf="loading">Registrando...</span>
          </button>
        </form>

        <div class="login-link">
          <p>쯏a tiene cuenta?</p>
          <button type="button" (click)="goToLogin()" class="link-button">
            Inicia sesi칩n aqu칤
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
