<div class="appointments-container">
  <button (click)="openCreateModal()" class="btn-add">
    Agregar Cita
  </button>

  <table class="appointments-table">
    <thead>
    <tr>
      <th>Título</th>
      <th>Inicio</th>
      <th>Fin</th>
      <th>Acciones</th>
    </tr>
    </thead>
    <tbody>
    <tr *ngFor="let appointment of appointments$ | async">
      <td>{{ appointment.title }}</td>
      <td>{{ appointment.start | date:'short' }}</td>
      <td>{{ appointment.end | date:'short' }}</td>
      <td>
        <button (click)="viewAppointment(appointment)" class="btn-view">Ver</button>
        <button (click)="deleteAppointment(appointment.id!)" class="btn-delete">Eliminar</button>
      </td>
    </tr>
    </tbody>
  </table>

  <!-- Modal -->
  <div *ngIf="showModal" class="modal-overlay" (click)="closeModal()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <h2>{{ selectedAppointment ? 'Editar' : 'Nueva' }} Cita</h2>

      <form [formGroup]="appointmentForm" (ngSubmit)="saveAppointment()">
        <div class="form-group">
          <label>Título</label>
          <input type="text" formControlName="title" />
        </div>

        <div class="form-group">
          <label>Inicio</label>
          <input type="datetime-local" formControlName="start" />
        </div>

        <div class="form-group">
          <label>Fin</label>
          <input type="datetime-local" formControlName="end" />
        </div>

        <div class="form-group">
          <label>Descripción</label>
          <textarea formControlName="description"></textarea>
        </div>

        <div class="modal-actions">
          <button type="button" (click)="closeModal()" class="btn-cancel">Cancelar</button>
          <button type="submit" [disabled]="appointmentForm.invalid" class="btn-save">Guardar</button>
        </div>
      </form>
    </div>
  </div>
</div>
